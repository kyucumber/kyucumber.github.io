{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/database/clustered-index-and-non-clustered-index","result":{"data":{"markdownRemark":{"id":"7e4fcfb6-b588-5f75-b126-ad6018a86bb7","html":"<p>개발을 진행할 때 데이터베이스의 인덱스나 조인(Nested Loop Join 등)에 대한 내용을 자주 다루지 않아서\n매번 필요할때 다시 찾아보고 있습니다. 또 까먹겠지만 다음에 조금 더 빨리 찾아볼 수 있도록 해당 내용을 정리합니다.</p>\n<blockquote>\n<p>아래 내용은 책이나 문서를 보며 아는 대로 정리한 부분이라 잘못된 부분이 있을 수 있습니다. 대부분의 내용은 MySQL을 기준으로 합니다.</p>\n</blockquote>\n<p>데이터베이스에서는 테이블의 데이터 검색 속도를 향상시켜주기 위해서 인덱스라는 개념을 제공하고 있습니다.\n인덱스는 컬럼 단위로 생성되며, 아래와 같이 하나의 컬럼 혹은 여러개의 컬럼에 하나의 인덱스를 생성할 수 있습니다.</p>\n<deckgo-highlight-code language=\"sql\"  terminal=\"carbon\" theme=\"one-light\" >\n          <code slot=\"code\">ALTER TABLE user ADD INDEX IDX_CLOSED_AT (closed_at);\nALTER TABLE user ADD INDEX IDX_CREATED_AT_AND_LAST_MOD_AT (created_at, last_modified_at);</code>\n        </deckgo-highlight-code>\n<p>별도로 인덱스를 만들지 않더라도 아래의 경우 자동으로 인덱스가 생성됩니다.</p>\n<ul>\n<li>Primary Key를 지정하는 경우 Clustered Index 생성</li>\n<li>Unique 제약 조건 지정 시 Non Clustered Index 생성</li>\n</ul>\n<p>인덱스는 Clustered Index, Non Clustered Index 두가지가 존재하며 각각에 대해서는 아래에서 설명합니다.</p>\n<h2 id=\"clustered-index\" style=\"position:relative;\"><a href=\"#clustered-index\" aria-label=\"clustered index permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Clustered Index</h2>\n<p>MySQL의 InnoDB 엔진에서는 B-Tree 기반 Clustered Index를 제공합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 959px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c16b98a6b0126f746f169a80b26bb741/d7abb/clustered-index.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.5%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABNklEQVQoz3WRiW7CMBBE8/8/VwnUXI2POPGROoHQBooCyXTtHhICVlpZ9tvZWdsJHsS6rjFDTJ8jnFUYeoflev3nzyL5E9/nEgusbbHdviBLtzifv24MH+VNw0fu+/0I7z1qVWOe57ubYL01SO4KKJZlwfF4xDRNUEohyzJsNhv4dx/PT6fT0wESrVtoo+lqBs45tG0DzjmtLfI8R+BV9YaiyOPKGKNaCykFMY2u62BIK4TAMAxIvO9RliUyEhsqrGmikCECC83TLI0GjDPsxzGyMHmappFrY1CRUd/3oaGDFBWK/JVENYxR8SMul5ncDRoliFHDRlIKetMdrvTbxjQ0bQFWFTSpinwkljgj0VkJyXPUsoQ1Ar77aWiJhT1nGQkqWM3xcdjFN+6cgvtljQpM4DAO+AYshV9/wHyxbQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/c16b98a6b0126f746f169a80b26bb741/8ac56/clustered-index.webp 240w,\n/static/c16b98a6b0126f746f169a80b26bb741/d3be9/clustered-index.webp 480w,\n/static/c16b98a6b0126f746f169a80b26bb741/1bae5/clustered-index.webp 959w\"\n          sizes=\"(max-width: 959px) 100vw, 959px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/c16b98a6b0126f746f169a80b26bb741/8ff5a/clustered-index.png 240w,\n/static/c16b98a6b0126f746f169a80b26bb741/e85cb/clustered-index.png 480w,\n/static/c16b98a6b0126f746f169a80b26bb741/d7abb/clustered-index.png 959w\"\n          sizes=\"(max-width: 959px) 100vw, 959px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/c16b98a6b0126f746f169a80b26bb741/d7abb/clustered-index.png\"\n          alt=\"clustered-index\"\n          title=\"clustered-index\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>Clustered Index를 기준으로 테이블 데이터를 물리적으로 재배열 하기 때문에 테이블 당 하나만 존재할 수 있습니다.</p>\n<p>Clustered Index의 Leaf Node에는 실제 Row 데이터가 저장됩니다. 물리적으로 정렬되어 있어 Clustered Index 사용 시 검색 속도가 빠릅니다. 정렬되지 않은 데이터를 적재할 경우 성능의 저하가 일어날 수 있으므로 Primary Key의 경우 Auto Increment와 같이 정렬 순서를 보장하는 편이 좋습니다.</p>\n<h2 id=\"non-clustered-index\" style=\"position:relative;\"><a href=\"#non-clustered-index\" aria-label=\"non clustered index permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Non Clustered Index</h2>\n<p>Clustered Index와 달리 하나의 테이블에 여러 Non Clustered Index를 생성할 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 678px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8b34df759994b862396a471b30c06458/38cea/non-clustered-index-01.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABbUlEQVQoz4VRDW+CMBTk//+oxWXJPoxZjEO+ZEJpKwoSBRWHgLe+Lopmur3kUvp6Pe5eDdyo4/GI/+oex7hHpHVbVhp5sUEYBmCMwf/0sdls7ooat4SomqbBuyvwNAzghTMlNoUQAixiKIrizL28RzAuN3TWfXd/PxwO8CYeTNOEZVnI8/xXqhPf+GteZVkiSRJEUYQsy8BCpqKHmM/n4JxjtVqjrusrYe2waVt8VTXqpkWaJjpav9/XIDe73RZxHMO2bYytMaqq0q5t20LvsQfHcbBcLrsZxsscDwMfzx8McjaD49oQUkIqUO33e7ieg5CFmAbTc2QhOHx/ohIwbeJmZIpG84pVLCLR45AgCdGec3F+ZYodBIFe5Ux2Dkm0bX+Ei3ytXzRNF0gU6OygIkrJ1exiLBaxni0VcYSIsFD9LEuvBU9O00TAHL0p9MEjV/fLcgvfHWI0fIXvDZXDteZK7qveCyxzoESZ7n0Demf9L2PcyrQAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/8b34df759994b862396a471b30c06458/8ac56/non-clustered-index-01.webp 240w,\n/static/8b34df759994b862396a471b30c06458/d3be9/non-clustered-index-01.webp 480w,\n/static/8b34df759994b862396a471b30c06458/7e03f/non-clustered-index-01.webp 678w\"\n          sizes=\"(max-width: 678px) 100vw, 678px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/8b34df759994b862396a471b30c06458/8ff5a/non-clustered-index-01.png 240w,\n/static/8b34df759994b862396a471b30c06458/e85cb/non-clustered-index-01.png 480w,\n/static/8b34df759994b862396a471b30c06458/38cea/non-clustered-index-01.png 678w\"\n          sizes=\"(max-width: 678px) 100vw, 678px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/8b34df759994b862396a471b30c06458/38cea/non-clustered-index-01.png\"\n          alt=\"non-clustered-index-01\"\n          title=\"non-clustered-index-01\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>Non Clustered Index의 Leaf Node에는 Clustered Index의 키가 포함됩니다. 자세한 내용은 살펴보지 않았지만 아래와 같이 Non Clustered Index를 이용해 검색이 일어나는 경우 아래와 같이 Non Clustered Index의 Leaf Node를 찾은 뒤 Clustered Index를 활용해 데이터를 조회하는 것 같습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 715px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9da214612f9a726998e1d37bc4994900/d0c0e/non-clustered-index-02.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACEklEQVQ4y4VTibKiMBD0/z/LkvWpTxBR8cAD5AZREEHx6J3MltbT1d1UpTJkQqdnulPDm3G73R5xnmdw7CUC38blcvkr/zpqryD3tTqfkR1OMC0Lv6Q6ut02yqJ4nHmdD8CfQD+TxbHCzE6wdgOoqgpd13GmS95V8QT4qYSqqnAsD9jEMebzORaLBTabDdI0xel0eiLxVPJ943q9wolSuNEW4/EYkiRhbdvY7XZQFAWj0YgZilWSGrCoFe9AnwCDJEeUZFRiH4YxRxhGSJIEmjbAdDpjUUzTIlCdGb/2/bnke/J6wXCoYqApxG6LKArRV7uYTIYMaFlLYtwh5c1/M7wnBNNtEiGOfBzyPcqyoO8QWZpwPs9TspCDoth/BnxH/S7MbruB2utgMh5QD6uPfr3HtXeeElMoWZDvoihiIYR19nvBuGRxPnmxhv+MMAxZdaF0EAR8iWjLpxdWY7s4DlzXhe/7/NNqtWLvCTNrmoZ2uw1ZlonpkO0izooznuexaKZpciXMUCgnLNFsNtFqtTAzDHx9tQg8oItcYtbjnLCKLCtsI1F6oyGhXq/Tv1N0Ot9ssweguZpD6yuQux0slwb0kYYsSxHHVK4+oHcsRBlhNtV5/5DnZKseFPmb9saUG8JznT+AV/JdHLn0xDwCNsgSa/p2qPkHtoqI7fUCvmdxfDqWOB4Ljj3XxNpacCzOivEbZCp27Jbzo88AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/9da214612f9a726998e1d37bc4994900/8ac56/non-clustered-index-02.webp 240w,\n/static/9da214612f9a726998e1d37bc4994900/d3be9/non-clustered-index-02.webp 480w,\n/static/9da214612f9a726998e1d37bc4994900/cb533/non-clustered-index-02.webp 715w\"\n          sizes=\"(max-width: 715px) 100vw, 715px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/9da214612f9a726998e1d37bc4994900/8ff5a/non-clustered-index-02.png 240w,\n/static/9da214612f9a726998e1d37bc4994900/e85cb/non-clustered-index-02.png 480w,\n/static/9da214612f9a726998e1d37bc4994900/d0c0e/non-clustered-index-02.png 715w\"\n          sizes=\"(max-width: 715px) 100vw, 715px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/9da214612f9a726998e1d37bc4994900/d0c0e/non-clustered-index-02.png\"\n          alt=\"non-clustered-index-02\"\n          title=\"non-clustered-index-02\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>인덱스는 검색 성능 향상을 위해 사용하지만, 테이블 내에 인덱스가 너무 많이 생성된 경우에는 DML 작업의 성능 저하가 일어날 수 있으므로 꼭 필요한 경우에만 인덱스를 추가하는것이 좋습니다.</p>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<p><a href=\"https://www.sqlservercentral.com/articles/nonclustered-index-structure\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://www.sqlservercentral.com/articles/nonclustered-index-structure</a></p>","tableOfContents":"<ul>\n<li><a href=\"/posts/database/clustered-index-and-non-clustered-index/#clustered-index\">Clustered Index</a></li>\n<li><a href=\"/posts/database/clustered-index-and-non-clustered-index/#non-clustered-index\">Non Clustered Index</a></li>\n<li><a href=\"/posts/database/clustered-index-and-non-clustered-index/#reference\">Reference</a></li>\n</ul>","fields":{"slug":"/posts/database/clustered-index-and-non-clustered-index","tagSlugs":["/tag/database/","/tag/clustered-index/","/tag/non-clustered-index/"]},"frontmatter":{"date":"2017-10-01T00:00:00.000Z","description":"Clustered Index와 Non Clustered Index에 대해 정리","tags":["Database","Clustered Index","Non Clustered Index"],"title":"Clustered Index와 Non Clustered Index","socialImage":{"publicURL":"/static/c16b98a6b0126f746f169a80b26bb741/clustered-index.png"}}}},"pageContext":{"slug":"/posts/database/clustered-index-and-non-clustered-index"}},"staticQueryHashes":["2067870509","251939775","401334301"]}