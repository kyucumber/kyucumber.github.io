{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/issues/aws-auto-scaling-group-pending/","result":{"data":{"markdownRemark":{"id":"6ca82dc3-2ffd-58d1-b079-9bb6349a2f9a","html":"<p>AWS Auto Scaling Group에서 인스턴스 생성이 Pending되는 이슈 발생.</p>\n<p>CodeDeploy 사용 시 Scale out 시 프로비저닝을 위해 ASG에 Lifecycle Hook이 설정된다.\nReplacement ASG로의 배포가 정상적으로 종료되면 Original ASG의 Lifecycle Hook을 제거해야하는데 Hook의 제거가 정상적으로 동작하지 않으면서 <code class=\"language-text\">Instance failed to complete user&#39;s Lifecycle Action</code>와 같은 에러 메세지와 함께 Pending이 발생된 것 같다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/1a867/aws-auto-scaling-group-pending-history.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 14.166666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAApUlEQVQI10WM25KCMBAF+f/vQ0U05GYSrBUCkUTf2shW7T509dSZmdN4MxIq45S4SsfhPNBdDcdecTxL2m7gdNEMOiDtuFtoz6HmbSfqTtGeBNr9cH8kmq28eVa2XEhbZpoXnK+PUqG0rdZIpekvAjFIbi788b3z4b7Pc1xrx4um5MxOybxKYV0XQvBYazDGYM2vvXNM04NliTtxnonxn5TW2lH4AIcU3kZ6Tpp3AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/8ac56/aws-auto-scaling-group-pending-history.webp 240w,\n/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/d3be9/aws-auto-scaling-group-pending-history.webp 480w,\n/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/e46b2/aws-auto-scaling-group-pending-history.webp 960w,\n/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/f992d/aws-auto-scaling-group-pending-history.webp 1440w,\n/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/882b9/aws-auto-scaling-group-pending-history.webp 1920w,\n/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/3c376/aws-auto-scaling-group-pending-history.webp 1998w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/8ff5a/aws-auto-scaling-group-pending-history.png 240w,\n/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/e85cb/aws-auto-scaling-group-pending-history.png 480w,\n/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/d9199/aws-auto-scaling-group-pending-history.png 960w,\n/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/07a9c/aws-auto-scaling-group-pending-history.png 1440w,\n/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/29114/aws-auto-scaling-group-pending-history.png 1920w,\n/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/1a867/aws-auto-scaling-group-pending-history.png 1998w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/e0ac669e8c8fb4f23b26ebf89d7c38d6/d9199/aws-auto-scaling-group-pending-history.png\"\n          alt=\"gatsby carbon\"\n          title=\"gatsby carbon\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>아래 ASG의 Lifecycle Hook 탭에서 해당 Lifecycle Hook을 수동으로 제거하면 정상적으로 동작한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/691611b16d87e79feea60a2d2ea88789/7f7f8/auto-scaling-group-lifecycle-hook.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 20.833333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsSAAALEgHS3X78AAAApUlEQVQY02WQ2w6DIBBE+f8v9EFD4wW8g5ZUwMZph0ReJDk5m80ySxDLsmAYBvR9j2makrdtg7U2s65r6u37Ds4bY/B5Gzg74nsG8FzXlSw43LZtCmIwL5znieM4Hnjvs0OIOHz4OyDGmGAt5nlGXdegx3FMZigXKKUeNE2DqqrweklordJjyrKElBJFUUA459B1Xb6gtc6+YfjdZ815wh6Xk/tLflCELdNrzJxaAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/691611b16d87e79feea60a2d2ea88789/8ac56/auto-scaling-group-lifecycle-hook.webp 240w,\n/static/691611b16d87e79feea60a2d2ea88789/d3be9/auto-scaling-group-lifecycle-hook.webp 480w,\n/static/691611b16d87e79feea60a2d2ea88789/e46b2/auto-scaling-group-lifecycle-hook.webp 960w,\n/static/691611b16d87e79feea60a2d2ea88789/f992d/auto-scaling-group-lifecycle-hook.webp 1440w,\n/static/691611b16d87e79feea60a2d2ea88789/882b9/auto-scaling-group-lifecycle-hook.webp 1920w,\n/static/691611b16d87e79feea60a2d2ea88789/e1a3b/auto-scaling-group-lifecycle-hook.webp 2396w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/691611b16d87e79feea60a2d2ea88789/8ff5a/auto-scaling-group-lifecycle-hook.png 240w,\n/static/691611b16d87e79feea60a2d2ea88789/e85cb/auto-scaling-group-lifecycle-hook.png 480w,\n/static/691611b16d87e79feea60a2d2ea88789/d9199/auto-scaling-group-lifecycle-hook.png 960w,\n/static/691611b16d87e79feea60a2d2ea88789/07a9c/auto-scaling-group-lifecycle-hook.png 1440w,\n/static/691611b16d87e79feea60a2d2ea88789/29114/auto-scaling-group-lifecycle-hook.png 1920w,\n/static/691611b16d87e79feea60a2d2ea88789/7f7f8/auto-scaling-group-lifecycle-hook.png 2396w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/691611b16d87e79feea60a2d2ea88789/d9199/auto-scaling-group-lifecycle-hook.png\"\n          alt=\"gatsby carbon\"\n          title=\"gatsby carbon\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>CodeDeploy agent가 위의 Lifecycle Hook을 제거해주는 작업을 정상적으로 수행해주지 못한것으로 보인다.\nCodeDeploy가 관리하는 ASG의 경우 Lifecycle Hook을 제거하면 Scale out 진행 시 프로비저닝이 정상적으로 동작하지 않으니 유의해서 제거하자.</p>","tableOfContents":"","fields":{"slug":"/posts/issues/aws-auto-scaling-group-pending/","tagSlugs":["/tag/aws/","/tag/cloud/","/tag/auto-scaling-group/"]},"frontmatter":{"date":"2018-10-01T00:00:00.000Z","description":"AWS Auto Scaling Group에서 인스턴스 생성이 Pending되는 이슈","tags":["AWS","Cloud","Auto Scaling Group"],"title":"AWS Auto Scaling groups -  Instance failed to complete user's Lifecycle Action error","socialImage":{"publicURL":"/static/69c1ea5ccd3b858a08b583ced6c5ccf0/gatsby.png"}}}},"pageContext":{"slug":"/posts/issues/aws-auto-scaling-group-pending/"}},"staticQueryHashes":["2067870509","251939775","401334301"]}