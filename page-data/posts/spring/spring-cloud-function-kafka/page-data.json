{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/spring/spring-cloud-function-kafka/","result":{"data":{"markdownRemark":{"id":"dbc12763-c988-5cab-b72d-587a904d3cdf","html":"<p><a href=\"https://github.com/spring-cloud/spring-cloud-function\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Spring Cloud Function</a>은 spring-cloud 하위의 프로젝트입니다.\nSpring Cloud Function을 이용하면 사용자가 정의한 <code class=\"language-text\">Supplier</code> <code class=\"language-text\">Consumer</code> <code class=\"language-text\">Function</code>등의 인터페이스를 <strong>FunctionCatalog</strong>가 읽어 Consume, Produce 등을 수행하는 표준 표현으로 변환하는 기능을 사용할 수 있습니다.</p>\n<p>Spring Cloud Function에서는 Java 8 부터 사용할 수 있는 3가지 코어 Function(<code class=\"language-text\">Supplier</code>, <code class=\"language-text\">Function</code>, <code class=\"language-text\">Consumer</code>) interface들을 지원합니다.\n각각의 인터페이스를 이용해 Kafka Producer, Consumer, Streams를 구성한 코드를 정리했습니다. </p>\n<h2 id=\"supplier-interface를-이용한-kafka-producer-구성하기\" style=\"position:relative;\"><a href=\"#supplier-interface%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-kafka-producer-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0\" aria-label=\"supplier interface를 이용한 kafka producer 구성하기 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Supplier interface를 이용한 Kafka Producer 구성하기</h2>\n<p>Supplier interface를 통해 Kafka Producer를 구성할 수 있습니다. 아래와 같은 의존성 및 properties가 정의되어야 합니다.\nProducer의 경우 Non Reactive 혹은 Reactive 방식으로 구성할 수 있습니다.</p>\n<p><code class=\"language-text\">build.gradle.kts</code></p>\n<deckgo-highlight-code language=\"kotlin\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">implementation(&quot;org.springframework.cloud:spring-cloud-function-kotlin&quot;)\nimplementation(&quot;org.springframework.cloud:spring-cloud-stream-binder-kafka&quot;)</code>\n        </deckgo-highlight-code>\n<p><a href=\"https://cloud.spring.io/spring-cloud-stream-binder-kafka/spring-cloud-stream-binder-kafka.html#_kafka_binder_properties\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kafka Binder Properties</a>, <a href=\"https://cloud.spring.io/spring-cloud-stream-binder-kafka/spring-cloud-stream-binder-kafka.html#kafka-producer-properties\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kafka Producer Properties</a></p>\n<p><code class=\"language-text\">application.yml</code></p>\n<deckgo-highlight-code language=\"yaml\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">spring:\n  profiles: local\n  cloud:\n    function:\n      definition: kotlinSupplier; # 함수 이름, 여러개인 경우 kotlinSupplier,kotlinConsumer; 이런 식으로 정의\n    stream:\n      bindings:\n        kotlinSupplier-out-0:\n          destination: backoffice-auth.local.logging.access-info.json #\n      kafka:\n        binder:\n          brokers: localhost\n          defaultBrokerPort: 9092\n          configuration:\n            acks: all\n        bindings:\n          kotlinSupplier-out-0:\n            producer: # producer 세부 설정, 별도로 설정할 부분이 없어 생략</code>\n        </deckgo-highlight-code>\n<h3 id=\"non-reactive-producer\" style=\"position:relative;\"><a href=\"#non-reactive-producer\" aria-label=\"non reactive producer permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Non Reactive Producer</h3>\n<p>Non Reactive 방식의 Producer를 정의하기 위해서 아래와 같이 설정할 수 있습니다.\n아래와 같이 설정하는 경우 <a href=\"https://github.com/spring-cloud/spring-cloud-stream/blob/master/spring-cloud-stream/src/main/java/org/springframework/cloud/stream/config/DefaultPollerProperties.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">default poller</a> 에 의해서 polling 방식(Non Reactive)을 통해 producing을 진행합니다.</p>\n<p><code class=\"language-text\">ProducerConfig</code></p>\n<deckgo-highlight-code language=\"kotlin\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">@Configuration\nclass ProducerConfig {\n    @Bean\n    fun kotlinSupplier() = Supplier&lt;String&gt; {\n        &quot;produce test&quot;\n    }\n}</code>\n        </deckgo-highlight-code>\n<p>아래와 같이 Polling 방식으로 producing이 진행되는것을 확인할 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dad2c90af96c4112cff042300d1c93ce/555cf/spring-cloud-function-supplier.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.083333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAYUlEQVQY06XNSw7DIBAEUe5/zmwsjBkYPsaIqci+gZOS3rLVLqROKgNVRZJggJn95M59tsS2Z0LY8d7TWqPW+sq9iTESjgPn5UR0UEoha2bZYq335pwPJ3qhbdJ7f57+7QvcJDm7xSnvJwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/dad2c90af96c4112cff042300d1c93ce/8ac56/spring-cloud-function-supplier.webp 240w,\n/static/dad2c90af96c4112cff042300d1c93ce/d3be9/spring-cloud-function-supplier.webp 480w,\n/static/dad2c90af96c4112cff042300d1c93ce/e46b2/spring-cloud-function-supplier.webp 960w,\n/static/dad2c90af96c4112cff042300d1c93ce/f992d/spring-cloud-function-supplier.webp 1440w,\n/static/dad2c90af96c4112cff042300d1c93ce/882b9/spring-cloud-function-supplier.webp 1920w,\n/static/dad2c90af96c4112cff042300d1c93ce/9ddbc/spring-cloud-function-supplier.webp 1960w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/dad2c90af96c4112cff042300d1c93ce/8ff5a/spring-cloud-function-supplier.png 240w,\n/static/dad2c90af96c4112cff042300d1c93ce/e85cb/spring-cloud-function-supplier.png 480w,\n/static/dad2c90af96c4112cff042300d1c93ce/d9199/spring-cloud-function-supplier.png 960w,\n/static/dad2c90af96c4112cff042300d1c93ce/07a9c/spring-cloud-function-supplier.png 1440w,\n/static/dad2c90af96c4112cff042300d1c93ce/29114/spring-cloud-function-supplier.png 1920w,\n/static/dad2c90af96c4112cff042300d1c93ce/555cf/spring-cloud-function-supplier.png 1960w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/dad2c90af96c4112cff042300d1c93ce/d9199/spring-cloud-function-supplier.png\"\n          alt=\"nonreactivesupplier\"\n          title=\"nonreactivesupplier\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<h3 id=\"reactive-producer\" style=\"position:relative;\"><a href=\"#reactive-producer\" aria-label=\"reactive producer permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reactive Producer</h3>\n<p>Reactive 방식의 Producer를 정의하기 위해서 아래와 같이 구성할 수 있습니다.\n예제 코드에서는 기본 구현체 중 하나인 <code class=\"language-text\">EmitterProcessor</code>를 이용했습니다.</p>\n<p><code class=\"language-text\">ProducerConfig</code></p>\n<deckgo-highlight-code language=\"kotlin\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">@Configuration\nclass ProducerConfig {\n    @Bean\n    fun processor(): EmitterProcessor&lt;String&gt; =\n        EmitterProcessor.create&lt;String&gt;()\n\n    @Bean\n    fun processorSink(processor: EmitterProcessor&lt;String&gt;): FluxSink&lt;String&gt; {\n        return processor.sink(FluxSink.OverflowStrategy.DROP)\n    }\n\n    @Bean\n    fun kotlinSupplier(processor: EmitterProcessor&lt;String&gt;) = Supplier&lt;Flux&lt;String&gt;&gt; {\n        processor\n    }\n}</code>\n        </deckgo-highlight-code>\n<p><code class=\"language-text\">ProduceTestController</code></p>\n<deckgo-highlight-code language=\"kotlin\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">@RestController\n@RequestMapping(&quot;/api/v1&quot;)\nclass ProduceTestController(\n    private val processorSink: FluxSink&lt;String&gt;\n) {\n    @GetMapping\n    fun produce() {\n        this.processorSink.next(UUID.randomUUID().toString())\n    }\n}</code>\n        </deckgo-highlight-code>\n<p>위와 같이 코드를 정의하고, 해당 <code class=\"language-text\">/api/v1</code> 경로로 GET 요청을 보내면 아래와 같이 producing이 진행됩니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2ba2991ce4f5a5049bc8316c86b3bae6/555cf/spring-cloud-function-reactive-supplier.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 22.083333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAWklEQVQY06WPWwqAIBQF2/8yIwIr7XbTfIFTLiE8MJy/gZnOO3FqZnOBebVohFwb0Git/79NTgvHVTAushhFAsQyIJS7Cyu7JIz1yANpRHj5gnS+VmMVn8aSXzfLO4v0BUOHAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/2ba2991ce4f5a5049bc8316c86b3bae6/8ac56/spring-cloud-function-reactive-supplier.webp 240w,\n/static/2ba2991ce4f5a5049bc8316c86b3bae6/d3be9/spring-cloud-function-reactive-supplier.webp 480w,\n/static/2ba2991ce4f5a5049bc8316c86b3bae6/e46b2/spring-cloud-function-reactive-supplier.webp 960w,\n/static/2ba2991ce4f5a5049bc8316c86b3bae6/f992d/spring-cloud-function-reactive-supplier.webp 1440w,\n/static/2ba2991ce4f5a5049bc8316c86b3bae6/882b9/spring-cloud-function-reactive-supplier.webp 1920w,\n/static/2ba2991ce4f5a5049bc8316c86b3bae6/9ddbc/spring-cloud-function-reactive-supplier.webp 1960w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/2ba2991ce4f5a5049bc8316c86b3bae6/8ff5a/spring-cloud-function-reactive-supplier.png 240w,\n/static/2ba2991ce4f5a5049bc8316c86b3bae6/e85cb/spring-cloud-function-reactive-supplier.png 480w,\n/static/2ba2991ce4f5a5049bc8316c86b3bae6/d9199/spring-cloud-function-reactive-supplier.png 960w,\n/static/2ba2991ce4f5a5049bc8316c86b3bae6/07a9c/spring-cloud-function-reactive-supplier.png 1440w,\n/static/2ba2991ce4f5a5049bc8316c86b3bae6/29114/spring-cloud-function-reactive-supplier.png 1920w,\n/static/2ba2991ce4f5a5049bc8316c86b3bae6/555cf/spring-cloud-function-reactive-supplier.png 1960w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/2ba2991ce4f5a5049bc8316c86b3bae6/d9199/spring-cloud-function-reactive-supplier.png\"\n          alt=\"nonreactivesupplier\"\n          title=\"nonreactivesupplier\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<h2 id=\"consumer-interface를-통해-kafka-consumer-구성하기\" style=\"position:relative;\"><a href=\"#consumer-interface%EB%A5%BC-%ED%86%B5%ED%95%B4-kafka-consumer-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0\" aria-label=\"consumer interface를 통해 kafka consumer 구성하기 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Consumer interface를 통해 Kafka Consumer 구성하기</h2>\n<p>Consumer interface를 통해 Kafka Consumer를 구성할 수 있습니다.\n아래와 같은 의존성 및 설정이 정의되어야 합니다.</p>\n<p><code class=\"language-text\">build.gradle.kts</code></p>\n<deckgo-highlight-code language=\"kotlin\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">implementation(&quot;org.springframework.cloud:spring-cloud-function-kotlin&quot;)\nimplementation(&quot;org.springframework.cloud:spring-cloud-stream-binder-kafka&quot;)</code>\n        </deckgo-highlight-code>\n<p><a href=\"https://cloud.spring.io/spring-cloud-stream-binder-kafka/spring-cloud-stream-binder-kafka.html#_kafka_binder_properties\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kafka Binder Properties</a>, <a href=\"https://cloud.spring.io/spring-cloud-stream-binder-kafka/spring-cloud-stream-binder-kafka.html#kafka-consumer-properties\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kafka Consumer Properties</a></p>\n<p><code class=\"language-text\">application.yml</code></p>\n<deckgo-highlight-code language=\"yaml\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">spring:\n  profiles: local\n  cloud:\n    function:\n      definition: kotlinConsumer;\n    stream:\n      kafka:\n        binder:\n          brokers: localhost\n          defaultBrokerPort: 9092\n          configuration:\n            acks: all\n        bindings:\n          kotlinConsumer-in-0:\n            startOffset: earliest\n      bindings:\n        kotlinConsumer-in-0:\n          group: kotlin-consumer # consumer group id\n          destination: topic # consume topic name</code>\n        </deckgo-highlight-code>\n<p><code class=\"language-text\">ConsumerConfig</code></p>\n<deckgo-highlight-code language=\"kotlin\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">@Configuration\nclass ConsumerConfig {\n    @Bean\n    fun kotlinConsumer() = Consumer&lt;String&gt; {\n        println(it)\n    }\n}</code>\n        </deckgo-highlight-code>\n<h2 id=\"function-interface를-이용해-kafka-streams-구성하기\" style=\"position:relative;\"><a href=\"#function-interface%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%B4-kafka-streams-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0\" aria-label=\"function interface를 이용해 kafka streams 구성하기 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Function interface를 이용해 Kafka Streams 구성하기</h2>\n<p>Function interface를 통해 Kafka Streams API를 구현할 수 있습니다. 아래와 같은 의존성 및 설정이 정의되어야 합니다.</p>\n<p><code class=\"language-text\">build.gradle.kts</code></p>\n<deckgo-highlight-code language=\"kotlin\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">dependencies {\n    implementation(&quot;org.springframework.cloud:spring-cloud-stream&quot;)\n    implementation(&quot;org.springframework.cloud:spring-cloud-stream-binder-kafka-streams&quot;)\n}</code>\n        </deckgo-highlight-code>\n<p><a href=\"https://cloud.spring.io/spring-cloud-stream-binder-kafka/spring-cloud-stream-binder-kafka.html#_kafka_streams_properties\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kafka Streams Properties</a></p>\n<p><code class=\"language-text\">application.yml</code></p>\n<deckgo-highlight-code language=\"yaml\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">spring:\n  profiles: local\n  cloud:\n    function:\n      definition: fullAuthAccessLogProcessor;\n    stream:\n      kafka:\n        streams:\n          binder:\n            brokers: localhost:9092\n            configuration:\n              acks: all\n          bindings:\n            fullAuthAccessLogProcessor-in-0:\n              consumer:\n                applicationId: access-info-log-processor\n      bindings:\n        fullAuthAccessLogProcessor-in-0:\n          destination: backoffice-auth.local.logging.access-info.json\n        fullAuthAccessLogProcessor-out-0:\n          destination: backoffice-auth.local.logging.full-access-info.json</code>\n        </deckgo-highlight-code>\n<p><code class=\"language-text\">StreamsConfig</code></p>\n<deckgo-highlight-code language=\"kotlin\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">@Configuration\nclass StreamsConfig {\n    @Bean\n    fun fullAuthAccessLogProcessor(fullAuthAccessInfoMapper: FullAuthAccessInfoMapper) =\n        Function&lt;KStream&lt;String, AuthAccessInfoSchema&gt;, KStream&lt;String, FullAuthAccessInfoSchema&gt;&gt; {\n            it.mapValues { value -&gt; fullAuthAccessInfoMapper.map(value) }\n        }\n\n    @Bean\n    fun fullAuthAccessInfoSchemaSerde(objectMapper: ObjectMapper): Serde&lt;FullAuthAccessInfoSchema&gt; =\n        JsonSerde(FullAuthAccessInfoSchema::class.java, objectMapper)\n}</code>\n        </deckgo-highlight-code>\n<h2 id=\"additional-options\" style=\"position:relative;\"><a href=\"#additional-options\" aria-label=\"additional options permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Additional Options</h2>\n<p>Spring Cloud Function에서는 여러 함수 설정, Composition, Kotlin lambda support 등의 추가적인 기능을 제공합니다.</p>\n<h3 id=\"multiple-functions-binding\" style=\"position:relative;\"><a href=\"#multiple-functions-binding\" aria-label=\"multiple functions binding permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Multiple Functions Binding</h3>\n<p>여러 Function들이 정의되는 경우 아래와 같이 definition을 통해 여러 함수를 지정해주어야 동작합니다.</p>\n<deckgo-highlight-code language=\"yaml\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">---\nspring:\n  profiles: local\n  cloud:\n    function:\n      definition: kotlinSupplier;kotlinConsumer</code>\n        </deckgo-highlight-code>\n<h3 id=\"declarative-function-composition\" style=\"position:relative;\"><a href=\"#declarative-function-composition\" aria-label=\"declarative function composition permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Declarative Function Composition</h3>\n<p>여러 Function들의 Composition 기능도 제공합니다.</p>\n<p><code class=\"language-text\">|</code>를 통해 Composition을 표현할 수 있습니다.</p>\n<deckgo-highlight-code language=\"yaml\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">spring:\n  profiles: local\n  cloud:\n    function:\n      definition: kotlinSupplier;uppercase|reverse</code>\n        </deckgo-highlight-code>\n<p><a href=\"https://github.com/spring-cloud/spring-cloud-stream-samples/blob/master/multi-functions-samples/function-composition-kafka/src/main/java/demo/FunctionCompositionDemoApplication.java\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Function Composition Example</a></p>\n<h3 id=\"kotlin-lambda-support\" style=\"position:relative;\"><a href=\"#kotlin-lambda-support\" aria-label=\"kotlin lambda support permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kotlin Lambda support</h3>\n<p>Kotlin lambda를 이용해 Functon, Supplier, Consumer를 구성하려는 경우 아래 의존성을 추가해야 합니다.</p>\n<deckgo-highlight-code language=\"kotlin\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">@Bean\nopen fun kotlinSupplier(): () -&gt; String {\n    return  { &quot;Hello from Kotlin&quot; }\n}\n\n@Bean\nopen fun kotlinFunction(): (String) -&gt; String {\n    return  { it.toUpperCase() }\n}\n\n@Bean\nopen fun kotlinConsumer(): (String) -&gt; Unit {\n    return  { println(it) }\n}</code>\n        </deckgo-highlight-code>\n<p><code class=\"language-text\">build.gradle.kts</code></p>\n<deckgo-highlight-code language=\"kotlin\"  terminal=\"carbon\" theme=\"dracula\" >\n          <code slot=\"code\">dependencies {\n    implementation(&quot;org.springframework.cloud:spring-cloud-function-kotlin&quot;)\n}</code>\n        </deckgo-highlight-code>\n<p>현재 작성된 버전 기준으로는 Kafka Streams에 대해서는 lambda support가 지원되지 않습니다.</p>\n<p><a href=\"https://github.com/spring-cloud/spring-cloud-stream-binder-kafka/issues/795\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/spring-cloud/spring-cloud-stream-binder-kafka/issues/795</a></p>","tableOfContents":"<ul>\n<li>\n<p><a href=\"/posts/spring/spring-cloud-function-kafka/#supplier-interface%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-kafka-producer-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0\">Supplier interface를 이용한 Kafka Producer 구성하기</a></p>\n<ul>\n<li><a href=\"/posts/spring/spring-cloud-function-kafka/#non-reactive-producer\">Non Reactive Producer</a></li>\n<li><a href=\"/posts/spring/spring-cloud-function-kafka/#reactive-producer\">Reactive Producer</a></li>\n</ul>\n</li>\n<li><a href=\"/posts/spring/spring-cloud-function-kafka/#consumer-interface%EB%A5%BC-%ED%86%B5%ED%95%B4-kafka-consumer-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0\">Consumer interface를 통해 Kafka Consumer 구성하기</a></li>\n<li><a href=\"/posts/spring/spring-cloud-function-kafka/#function-interface%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%B4-kafka-streams-%EA%B5%AC%EC%84%B1%ED%95%98%EA%B8%B0\">Function interface를 이용해 Kafka Streams 구성하기</a></li>\n<li>\n<p><a href=\"/posts/spring/spring-cloud-function-kafka/#additional-options\">Additional Options</a></p>\n<ul>\n<li><a href=\"/posts/spring/spring-cloud-function-kafka/#multiple-functions-binding\">Multiple Functions Binding</a></li>\n<li><a href=\"/posts/spring/spring-cloud-function-kafka/#declarative-function-composition\">Declarative Function Composition</a></li>\n<li><a href=\"/posts/spring/spring-cloud-function-kafka/#kotlin-lambda-support\">Kotlin Lambda support</a></li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/posts/spring/spring-cloud-function-kafka/","tagSlugs":["/tag/spring-cloud-function/","/tag/kafka/"]},"frontmatter":{"date":"2020-10-03T00:00:00.000Z","description":"Spring Cloud Function을 이용해 Spring에서 Kafka Producer, Consumer, Streams 코드를 작성하는 방법을 정리합니다.","tags":["Spring Cloud Function","Kafka"],"title":"Spring Cloud Function을 이용한 Kafka Client 구성하기","socialImage":{"publicURL":"/static/69c1ea5ccd3b858a08b583ced6c5ccf0/gatsby.png"}}}},"pageContext":{"slug":"/posts/spring/spring-cloud-function-kafka/"}},"staticQueryHashes":["2067870509","251939775","401334301"]}