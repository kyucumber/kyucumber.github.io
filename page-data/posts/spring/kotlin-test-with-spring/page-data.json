{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/spring/kotlin-test-with-spring","result":{"data":{"markdownRemark":{"id":"73d17936-2b69-5979-ae34-4bcf8f0d0ca6","html":"<h2 id=\"개요\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EC%9A%94\" aria-label=\"개요 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개요</h2>\n<p>스프링 기반 프로젝트에서 코틀린을 사용하더라도 아래와 같이 기존에 사용하던 테스트 프레임워크인 <code class=\"language-text\">Junit</code>, <code class=\"language-text\">Assertion</code>, <code class=\"language-text\">Mockito</code> 등은 동일하게 사용할 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2691faaea6a713b79b43c8f53e0f1cdd/8b640/kotlin-with-junit-test.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABSklEQVQoz42S63KCMBCFef/H64/iTIt4oYWiguQeIn5N6Og4HWtN5kzIsjk5e7KZsx550IhWcdxZmj1UtaX6POK943yGaZpmnOPmPmLOeaJVLdk4jjjj6Hc9apD0R43RBikV6d8zI5GmMcU1C6cTUgjKZUX+1lEWNU35ztd6RVPX7A8Huq5jGAa0M2hvY75EGY10+nrpRW3mvZ8DIipbbxV1I9hu15TliuVySVEUVFWFMYYxBHwYsdbiR48LnlMUdKt0LjkFk1/WKrRW84FEkKC1JkSiZ0q+EgYf6OojfSswwl8T/jp8D1fCS8laGPLFlpfXDzZVF8uNpa5WhOiVVZJBiln5Lem971nhJbDZbMjznKZpWCwWiF3LKAZMf0D0Hbtuj4qWPFKaOee4+Phve8SZ+u2RHbPC1LSPbv2NlD97Hx8rCUnrD058A0EyDE7SeZ/dAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/2691faaea6a713b79b43c8f53e0f1cdd/8ac56/kotlin-with-junit-test.webp 240w,\n/static/2691faaea6a713b79b43c8f53e0f1cdd/d3be9/kotlin-with-junit-test.webp 480w,\n/static/2691faaea6a713b79b43c8f53e0f1cdd/e46b2/kotlin-with-junit-test.webp 960w,\n/static/2691faaea6a713b79b43c8f53e0f1cdd/f992d/kotlin-with-junit-test.webp 1440w,\n/static/2691faaea6a713b79b43c8f53e0f1cdd/7017d/kotlin-with-junit-test.webp 1454w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/2691faaea6a713b79b43c8f53e0f1cdd/8ff5a/kotlin-with-junit-test.png 240w,\n/static/2691faaea6a713b79b43c8f53e0f1cdd/e85cb/kotlin-with-junit-test.png 480w,\n/static/2691faaea6a713b79b43c8f53e0f1cdd/d9199/kotlin-with-junit-test.png 960w,\n/static/2691faaea6a713b79b43c8f53e0f1cdd/07a9c/kotlin-with-junit-test.png 1440w,\n/static/2691faaea6a713b79b43c8f53e0f1cdd/8b640/kotlin-with-junit-test.png 1454w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/2691faaea6a713b79b43c8f53e0f1cdd/d9199/kotlin-with-junit-test.png\"\n            alt=\"kotlin with junit test\"\n            title=\"kotlin with junit test\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>초기 코틀린에 익숙하지 않은 상태에서 관련 지식이 없어 위와 같은 형태로 Junit, AssertJ, Mockito를 사용해 테스트를 작성했었습니다. 하지만 코틀린에 익숙해질수록 <strong>코틀린 스타일의 테스트를 작성할 수 없어</strong> 아쉬움을 느꼈습니다.</p>\n<p>이 글에서는 코틀린에서 Junit, AssertJ, Mockito를 사용해 테스트를 작성하는 경우의 문제점과 코틀린 진영에서 많이 사용되는 Testing 도구인 Kotest 및 Mockk 등에 대해 알아봅니다.</p>\n<h2 id=\"코틀린-dsl과-코틀린-스타일의-테스트코드\" style=\"position:relative;\"><a href=\"#%EC%BD%94%ED%8B%80%EB%A6%B0-dsl%EA%B3%BC-%EC%BD%94%ED%8B%80%EB%A6%B0-%EC%8A%A4%ED%83%80%EC%9D%BC%EC%9D%98-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%BD%94%EB%93%9C\" aria-label=\"코틀린 dsl과 코틀린 스타일의 테스트코드 permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>코틀린 DSL과 코틀린 스타일의 테스트코드</h2>\n<p>코틀린에서는 아래와 형태와 같은 DSL(Domain Specific Language) 스타일의 중괄호를 활용한 코드 스타일을 제공합니다. 코틀린 내부에서 제공하는 Standard library 대부분도 DSL을 이용해 작성된 것을 볼 수 있습니다.</p>\n<ul>\n<li><a href=\"https://play.kotlinlang.org/byExample/09_Kotlin_JS/06_HtmlBuilder?_gl=1*scn3we*_ga*MTExMjE5OTk1NC4xNjExNjY4NzEx*_ga_J6T75801PF*MTYyNDM2NTA0Mi4xMDguMC4xNjI0MzY1MDQyLjA.&#x26;_ga=2.54260653.40338281.1624343617-1112199954.1611668711\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Type safe builders</a></li>\n<li><a href=\"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.collections/-list/#kotlin.collections.List\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kotlin Standard Library</a>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 15.833333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAh0lEQVQI132OywqDMBRE/f+f7KIL69WqeZrkxpymQqGL0oEDs5iBM+SUsHvhsYAxkdVsWOcQEYy1xHRgvcPHQK2V1tpPznYiThiOEFnEc7tnxikgsyDTyCwTZt9wwV/kkulP/kWrMqRu6JzpbKzPBe89Tfv5VFoffOdj8zYtpaCqnXfXq9feX4AG6eE/7V46AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e8d71d59ae84d469bcf8c845de547a9e/8ac56/kotlin-dsl-filter.webp 240w,\n/static/e8d71d59ae84d469bcf8c845de547a9e/d3be9/kotlin-dsl-filter.webp 480w,\n/static/e8d71d59ae84d469bcf8c845de547a9e/e46b2/kotlin-dsl-filter.webp 960w,\n/static/e8d71d59ae84d469bcf8c845de547a9e/f992d/kotlin-dsl-filter.webp 1440w,\n/static/e8d71d59ae84d469bcf8c845de547a9e/7017d/kotlin-dsl-filter.webp 1454w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e8d71d59ae84d469bcf8c845de547a9e/8ff5a/kotlin-dsl-filter.png 240w,\n/static/e8d71d59ae84d469bcf8c845de547a9e/e85cb/kotlin-dsl-filter.png 480w,\n/static/e8d71d59ae84d469bcf8c845de547a9e/d9199/kotlin-dsl-filter.png 960w,\n/static/e8d71d59ae84d469bcf8c845de547a9e/07a9c/kotlin-dsl-filter.png 1440w,\n/static/e8d71d59ae84d469bcf8c845de547a9e/8b640/kotlin-dsl-filter.png 1454w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e8d71d59ae84d469bcf8c845de547a9e/d9199/kotlin-dsl-filter.png\"\n            alt=\"kotlin dsl filter\"\n            title=\"kotlin dsl filter\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n    </span></li>\n<li><a href=\"https://kotlinlang.org/docs/scope-functions.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kotlin Scope Functions (let, also, apply, run ..)</a></li>\n</ul>\n<p>기존에 사용하던 Junit과 AssertJ, Mockito를 사용해 테스트를 진행하게 되면 위와 같은 코틀린 스타일의 테스트 코드를 작성할 수 없습니다.\n비즈니스 로직을 코틀린 DSL을 이용해 잘 작성하더라도 테스트에서 예전 방식의 코드를 작성해야 하다 보니 코틀린에 익숙해질수록 테스트 작성이 어색해지게 됩니다.</p>\n<p><a href=\"https://kotest.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kotest</a>나 <a href=\"https://mockk.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Mockk</a>와 같은 도구들을 사용하면 아래처럼 코틀린 DSL과 Infix를 사용해 코틀린 스타일의 테스트 코드를 작성할 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 960px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/907a791ed6f8ad9865dbbe029f230f52/3115b/kotlin-style-test-code.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.916666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABEUlEQVQoz42Ri27DIAxF8/9/uLTNuuYdIEBeJITkzlBN2rJGqqUrDFjm+BJNrcDYKgxqwKhHygVUVWJZFuzbBmdtWI+x7/sfbVTDeoZIpynS+I7POMfHpUD2eOB6iXFLEsimBkuu4HmGnnLOGRhjmOc5NDnG6iwiO4xQfKDiBVyuGPoegvMg5lVXGJWEMyZQzyTn3D/CJzYQGXqtbgSqRkKIDm2WokhugaooS7proLTGq/hp9HuNTKfRS0n+KYxSYKCxTN/BEpElmnVdYb2PB6JXhKHhpDSaXKLJyJ+vOzh5JVqJeZpC0zOyM9HICzQZ7UcUNK5b36M5eyh6Fux+F7S/oYUsMGYOn+Tt8L/uc3/+DWsTbsO4L2agAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/907a791ed6f8ad9865dbbe029f230f52/8ac56/kotlin-style-test-code.webp 240w,\n/static/907a791ed6f8ad9865dbbe029f230f52/d3be9/kotlin-style-test-code.webp 480w,\n/static/907a791ed6f8ad9865dbbe029f230f52/e46b2/kotlin-style-test-code.webp 960w,\n/static/907a791ed6f8ad9865dbbe029f230f52/f992d/kotlin-style-test-code.webp 1440w,\n/static/907a791ed6f8ad9865dbbe029f230f52/882b9/kotlin-style-test-code.webp 1920w,\n/static/907a791ed6f8ad9865dbbe029f230f52/9eba6/kotlin-style-test-code.webp 3924w\"\n              sizes=\"(max-width: 960px) 100vw, 960px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/907a791ed6f8ad9865dbbe029f230f52/8ff5a/kotlin-style-test-code.png 240w,\n/static/907a791ed6f8ad9865dbbe029f230f52/e85cb/kotlin-style-test-code.png 480w,\n/static/907a791ed6f8ad9865dbbe029f230f52/d9199/kotlin-style-test-code.png 960w,\n/static/907a791ed6f8ad9865dbbe029f230f52/07a9c/kotlin-style-test-code.png 1440w,\n/static/907a791ed6f8ad9865dbbe029f230f52/29114/kotlin-style-test-code.png 1920w,\n/static/907a791ed6f8ad9865dbbe029f230f52/3115b/kotlin-style-test-code.png 3924w\"\n            sizes=\"(max-width: 960px) 100vw, 960px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/907a791ed6f8ad9865dbbe029f230f52/d9199/kotlin-style-test-code.png\"\n            alt=\"kotlin style test code\"\n            title=\"kotlin style test code\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"kotest\" style=\"position:relative;\"><a href=\"#kotest\" aria-label=\"kotest permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kotest</h2>\n<p>코틀린 진영에서 가장 많이 사용되는 테스트 프레임워크입니다. 코틀린 DSL을 통한 테스트 작성을 지원합니다.\n<code class=\"language-text\">Kotest</code> 에서는 String Spec, Annotation Spec, Describe Spec 등의 테스트 레이아웃을 제공하며 Assertion을 위한 라이브러리 기능도 제공하고 있습니다.</p>\n<p>Kotest를 사용하기 위해서는 아래와 같은 설정 / 의존성 추가가 필요합니다.</p>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">test {\n    useJUnitPlatform()\n}\n\ndependencies {\n    testImplementation(&quot;io.kotest:kotest-runner-junit5:${Versions.KOTEST}&quot;)\n    testImplementation(&quot;io.kotest:kotest-assertions-core:${Versions.KOTEST}&quot;)\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"kotest-test-framework\" style=\"position:relative;\"><a href=\"#kotest-test-framework\" aria-label=\"kotest test framework permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kotest Test Framework</h3>\n<p>Kotest는 테스트를 위한 10가지 가량의 레이아웃을 제공합니다</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 902px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a82ffeca95ac2bbdc856d40742ef0da7/58213/kotest-test-frameworks.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 130.83333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAAAsTAAALEwEAmpwYAAADT0lEQVRIx42ViZLiOBBE+f+fm96YvjlnGtOADT7kA0syuZUl2xzBzqwjEh+Sy6Wsp2LSdWf4rsMZtwefed+h6y66P/ju9TjvJ957HVytfuH55RVPT/9guVz1L8iHzucxGJ//eHrCz+dnnXc6nfQ55wzzJl4nn+Fsi/ZUoyxL1HWj2fm7rJqmQV4UqKoahTFwzo1Z+j7LCX9M7ZGWHeK8g7uKwQw2mw2+1mskSYJHx5DdmCF/6pNHUTkkuUVraUH4Ytu2SA4HDZbleQhwE+w2MN+ZOPEwzWscRWlRI0lrxKJSlmXKClmWIxUlhyN2+xj7OBl1OKb43u4Qbb5xTDMwlhYlikssNwa/tyVW3wYLuTYSkIE+pzPM5gvMF0sspXCz+RLT2RxzKRDvF3J+eX3DOtqo7xP+WOtg3UXeO33WtjaMidzV+ICIFkL9E8wkMWrCuzj3+EocooPDcmdRt+exKMRpsVggiiJMp1O5X2nwR8fIYSvIeGdlYhAza04tTnL2PRIDRqFYVsbC+CiZ7wcPf20N5pHBdG0wE+WmQiUsHo4Z3j+meHv/UA+fX970PssLHafPZXUpIO3QgGXVoCgFWtMgE3GphHuYyOIUhdFKDsHq5nQjPnNOMjyfO4Hai49OAT+aoHPv4XodCYcH1UGYjAWXwcNrqG/ADoEcyoY7xiGVa1aPYDNALlCnkl0sgFPWWv1gdxdMAzLNrOihzipZei2ZheUWplSgCTGXOxSg6u0YVPVnZq4BNwRbgP78KrBJyn5iozuBBXl5fVeAB0+vi/GgKAFswjxIobZWNXaTYQP8QQFscSMpJMujx+/YYZv6m3Y1F6gJNLvO344L2GI+jSawzIrXJwW77bMNW45j9LB9IM7VDNkhvnYBaAJOuL+T0GQJNhsDm8H7x6fwWIx+/aeHDGikAHkZ4CbYPA9gE+pcYCbQIVMfYFa4B12BTcOLHui88uInXwp/C1zKYWiwEni/3/9/sOPMIROo9xl9DAHpC4NtpYnyHEnP2+32GvAC8x3YNNKUl73Ma4KeG3pTyZ+S0eVcCuPGJd5Ll6wde19ql2ZBCDjPm7jS3cFisM2PUD8oSBirQ1GYJpdA+f6s3dnaHtZOv9xa+0eowybo8C+x69xsP+9ZMQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a82ffeca95ac2bbdc856d40742ef0da7/8ac56/kotest-test-frameworks.webp 240w,\n/static/a82ffeca95ac2bbdc856d40742ef0da7/d3be9/kotest-test-frameworks.webp 480w,\n/static/a82ffeca95ac2bbdc856d40742ef0da7/5cb76/kotest-test-frameworks.webp 902w\"\n              sizes=\"(max-width: 902px) 100vw, 902px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a82ffeca95ac2bbdc856d40742ef0da7/8ff5a/kotest-test-frameworks.png 240w,\n/static/a82ffeca95ac2bbdc856d40742ef0da7/e85cb/kotest-test-frameworks.png 480w,\n/static/a82ffeca95ac2bbdc856d40742ef0da7/58213/kotest-test-frameworks.png 902w\"\n            sizes=\"(max-width: 902px) 100vw, 902px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a82ffeca95ac2bbdc856d40742ef0da7/58213/kotest-test-frameworks.png\"\n            alt=\"kotlin test frameworks\"\n            title=\"kotlin test frameworks\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>Kotest에서 익숙하고 많이 사용하는 몇가지 스타일에 대해 살펴보겠습니다.</p>\n<ul>\n<li><a href=\"https://github.com/kyucumber/kotlin-testing-with-spring-boot/blob/master/src/test/kotlin/org/kyucumber/CalculatorAnnotationSpec.kt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kotest Annotation Spec</a></li>\n</ul>\n<p>기존 Junit 방식과 가장 유사한 방식입니다. 별 다른 장점이 없는 레이아웃이지만 Junit에서 Kotest로의 마이그레이션이 필요한 상황이라면 나쁘지 않은 선택이 될 수 있습니다.</p>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">internal class CalculatorAnnotationSpec: AnnotationSpec() {\n    private val sut = Calculator()\n\n    @Test\n    fun `1과 2를 더하면 3이 반환된다`() {\n        val result = sut.calculate(&quot;1 + 2&quot;)\n\n        result shouldBe 3\n    }\n\n    @Test\n    fun `식을 입력하면, 해당하는 결과값이 반환된다`() {\n        calculations.forAll { (expression, answer) -&gt;\n            val result = sut.calculate(expression)\n\n            result shouldBe answer\n        }\n    }\n\n    @Test\n    fun `입력값이 null 이거나 빈 공백 문자일 경우 IllegalArgumentException 예외를 던진다`() {\n        blanks.forAll {\n            shouldThrow&lt;IllegalArgumentException&gt; {\n                sut.calculate(it)\n            }\n        }\n    }\n\n    @Test\n    fun `사칙연산 기호 이외에 다른 문자가 연산자로 들어오는 경우 IllegalArgumentException 예외를 던진다 `() {\n        invalidInputs.forAll {\n            shouldThrow&lt;IllegalArgumentException&gt; {\n                sut.calculate(it)\n            }\n        }\n    }\n\n    private val calculations = listOf(\n        &quot;1 + 3 * 5&quot; to 20.0,\n        &quot;2 - 8 / 3 - 3&quot; to -5.0,\n        &quot;1 + 2 + 3 + 4 + 5&quot; to 15.0\n    )\n    private val blanks = listOf(&quot;&quot;, &quot; &quot;, &quot;    &quot;)\n    private val invalidInputs = listOf(&quot;1 &amp; 2&quot;, &quot;1 + 5 % 1&quot;)\n}</code>\n        </deckgo-highlight-code>\n<ul>\n<li><a href=\"https://github.com/kyucumber/kotlin-testing-with-spring-boot/blob/master/src/test/kotlin/org/kyucumber/CalculatorBehaviorSpec.kt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kotest Behavior Spec</a></li>\n</ul>\n<p>기존 스프링 기반 프로젝트에서 작성하던 Given, When, Then 패턴을 코틀린 DSL을 이용해 간결하게 정의할 수 있습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 934px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/7e1a287b1faa14fe1c725c6bb8e1d4b6/078fe/kotest-behavior-spec.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.583333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACGUlEQVQoz01T2XLbMAzUl7TTmSZppp00aSZOY0s8dJsSJerwkeP/f2MLwFbqhxUoQlwusFC0dR6JSWGLGm0/oOnCZ3Q+wIcJNq+wUQYvsfqPROPvOW6UPUFbRKbOsT++CbowYNrtEcYJ47zDOM0Iw4ita5AXBVrv0bQtXNOgqkmA71BWNRKlCBoxIdqkKe6Nw2+7xaNp8KAd7tUWV08pvv3R+Hof48vdRuJ32rt5znG9ynC1SvHjpcD1c0a5BD/XBe7iChGXervS+JVYrGsP7WYoN2KVebrA4Slt8Zx3WFeDrBmcu10ZXD8muHnSggdV4VHXiPKyhtIGNs2Q1Rn6KWCgksMwYL8/oA8BRVlKaXlRypphrIU2CwyyvJB8pGyKNTWcm5rQWlcZunEUYzxh3B0Qph0ZU4oJ/O1ajDBnWNlTlgSRuEiRw5IglTG5FFuD3FVk0AjXdhjInOPbB8raibsLGX97GZkwZYX8WBI8Piq3aPpOxsYT6e74Ss5T6cNEByqU2wY2Kz7PXBJyFZHzvdx6SVh5JwrHeS9kLZHvDq/oqbfH9w+JTLAoZmhRSC5zKZe3JalF0dboSBGrYtKBeshrT3MaaDb5ve2D9LjpeukdixFCvmnpoTIZVJGiCT0aUn4iOB0O4yzkHDsadq7g8PpOpp32uA2MaHFrURjTOGSuFEV8aN4fxRg+OMwnMDHn+e/ilrB56qzwH3nAsqxu25agAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/7e1a287b1faa14fe1c725c6bb8e1d4b6/8ac56/kotest-behavior-spec.webp 240w,\n/static/7e1a287b1faa14fe1c725c6bb8e1d4b6/d3be9/kotest-behavior-spec.webp 480w,\n/static/7e1a287b1faa14fe1c725c6bb8e1d4b6/7d4d8/kotest-behavior-spec.webp 934w\"\n              sizes=\"(max-width: 934px) 100vw, 934px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/7e1a287b1faa14fe1c725c6bb8e1d4b6/8ff5a/kotest-behavior-spec.png 240w,\n/static/7e1a287b1faa14fe1c725c6bb8e1d4b6/e85cb/kotest-behavior-spec.png 480w,\n/static/7e1a287b1faa14fe1c725c6bb8e1d4b6/078fe/kotest-behavior-spec.png 934w\"\n            sizes=\"(max-width: 934px) 100vw, 934px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/7e1a287b1faa14fe1c725c6bb8e1d4b6/078fe/kotest-behavior-spec.png\"\n            alt=\"kotest behavior spec\"\n            title=\"kotest behavior spec\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">internal class CalculatorBehaviorSpec : BehaviorSpec({\n    val sut = Calculator()\n    given(&quot;calculate&quot;) {\n        val expression = &quot;1 + 2&quot;\n        `when`(&quot;1과 2를 더하면&quot;) {\n            val result = sut.calculate(expression)\n            then(&quot;3이 반환된다&quot;) {\n                result shouldBe 3\n            }\n        }\n\n        val calculations = listOf(\n            &quot;1 + 3 * 5&quot; to 20.0,\n            &quot;2 - 8 / 3 - 3&quot; to -5.0,\n            &quot;1 + 2 + 3 + 4 + 5&quot; to 15.0\n        )\n        `when`(&quot;수식을 입력하면&quot;) {\n            then(&quot;해당하는 결과값이 반환된다&quot;) {\n                calculations.forAll { (expression, answer) -&gt;\n                    val result = sut.calculate(expression)\n\n                    result shouldBe answer\n                }\n            }\n        }\n\n        val blanks = listOf(&quot;&quot;, &quot; &quot;, &quot;    &quot;)\n        `when`(&quot;입력값이 null이거나 빈 값인 경우&quot;) {\n            then(&quot;IllegalArgumentException 예외를 던진다&quot;){\n                blanks.forAll {\n                    shouldThrow&lt;IllegalArgumentException&gt; {\n                        sut.calculate(it)\n                    }\n                }\n            }\n        }\n\n        val invalidInputs = listOf(&quot;1 &amp; 2&quot;, &quot;1 + 5 % 1&quot;)\n        `when`(&quot;사칙연산 기호 이외에 다른 연산자가 들어오는 경우&quot;) {\n            then(&quot;IllegalArgumentException 예외를 던진다&quot;){\n                invalidInputs.forAll {\n                    shouldThrow&lt;IllegalArgumentException&gt; {\n                        sut.calculate(it)\n                    }\n                }\n            }\n        }\n    }\n})</code>\n        </deckgo-highlight-code>\n<ul>\n<li><a href=\"https://github.com/kyucumber/kotlin-testing-with-spring-boot/blob/master/src/test/kotlin/org/kyucumber/CalculatorDescribeSpec.kt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kotest Describe Spec</a></li>\n</ul>\n<p>Describe, Context, It 패턴으로 테스트를 작성해보셨던 분들이라면 익숙한 스타일입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 938px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ec33dc2665e4b3464bf002da57af2d43/dc333/kotest-describe-spec.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACMklEQVQoz2WR6W7TQBSF/UhQqWQZe7yMPd53O44TloJUhaiAEOov2vIISEAFJTzs4c6kaYn4cXRmu9/cxYibl7DSEV79Gtm4Ib1Fsd4iXW6Qr7Yon1/ou3k0YOo3mMkWs4A8OHgDFnYPMiwpUC9GVMMLiKREWPbwsxpR2SKpOgRZCUcmsIWPOImRZIl2GUnEKXkoMTfnJIYpYzC4H4Kvv8J+8xP5Zody+wfFdodnwy1Ouh84ab/jSfNNr0+Xd6Rf97rDZLXDlPS0u4V79hvh+Q5GEGWYROdg9QfI9SWqsy8oXl0jXF3BHz6TXyNa3yAkBePVw54VH3EaX2CSvCO9h9N8gt9fwvB8CWbOwDmjshjizEfbVKjrHELYcF0LjmM+ymbw6IzzOUxzCoukXN15nk0lux4Yd8FsD5YjwAOBuCxQtQvU3QJ+mIB7ARxqjS0kXHKT3h1itGht0xshIxqKow4cmLarxWwHfhqibntkZYV+OaKoGq28qtHQJ0KGxzG05q6AF0gYIthfKpCCW8JFmCfIyxpl06JbLKkNhX4zmZs0SesIdgCqWI9YRlpUYJZ9BEyqHE0/UNk9+UKrqBtEKfWVghR0ZnItncy/QD+M/ytZ5jFaAqryqqbTMLXuhqXOvKhbfZZRMoeWcQWkARuq9sdfhM4wKlINUCWXFKyGs/deg/ph1K1QH6gKE2qJI4I9cK7KPeqJAzf2CdbpwahsyvuMqrbTAPWZgqs3CqSy1EMh4F8OP8Hk/OI56QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/ec33dc2665e4b3464bf002da57af2d43/8ac56/kotest-describe-spec.webp 240w,\n/static/ec33dc2665e4b3464bf002da57af2d43/d3be9/kotest-describe-spec.webp 480w,\n/static/ec33dc2665e4b3464bf002da57af2d43/e5056/kotest-describe-spec.webp 938w\"\n              sizes=\"(max-width: 938px) 100vw, 938px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/ec33dc2665e4b3464bf002da57af2d43/8ff5a/kotest-describe-spec.png 240w,\n/static/ec33dc2665e4b3464bf002da57af2d43/e85cb/kotest-describe-spec.png 480w,\n/static/ec33dc2665e4b3464bf002da57af2d43/dc333/kotest-describe-spec.png 938w\"\n            sizes=\"(max-width: 938px) 100vw, 938px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/ec33dc2665e4b3464bf002da57af2d43/dc333/kotest-describe-spec.png\"\n            alt=\"kotest describe spec\"\n            title=\"kotest describe spec\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">internal class CalculatorDescribeSpec : DescribeSpec({\n    val sut = Calculator()\n\n    describe(&quot;calculate&quot;) {\n        context(&quot;식이 주어지면&quot;) {\n            val inputs = listOf(\n                &quot;1 + 3 * 5&quot; to 20.0,\n                &quot;2 - 8 / 3 - 3&quot; to -5.0,\n                &quot;1 + 2 + 3 + 4 + 5&quot; to 15.0\n            )\n\n            it(&quot;해당 식에 대한 결과값이 반환된다&quot;) {\n                inputs.forAll { (expression, data) -&gt;\n                    val result = sut.calculate(expression)\n\n                    result shouldBe data\n                }\n            }\n        }\n\n        context(&quot;0으로 나누는 경우&quot;) {\n            it(&quot;Infinity를 반환한다&quot;) {\n                val result = sut.calculate(&quot;1 / 0&quot;)\n\n                result shouldBe Double.POSITIVE_INFINITY\n            }\n        }\n\n        context(&quot;입력값이 null이거나 공백인 경우&quot;) {\n            val blanks = listOf(&quot;&quot;, &quot; &quot;, &quot;      &quot;)\n            it(&quot;IllegalArgumentException 예외를 던진다&quot;) {\n                blanks.forAll {\n                    shouldThrow&lt;IllegalArgumentException&gt; {\n                        sut.calculate(it)\n                    }\n                }\n            }\n        }\n\n        context(&quot;사칙연산 기호 이외에 다른 문자가 연산자로 들어오는 경우&quot;) {\n            val invalidInputs = listOf(&quot;1 &amp; 2&quot;, &quot;1 + 5 % 1&quot;)\n            it(&quot;IllegalArgumentException 예외를 던진다&quot;) {\n                invalidInputs.forAll {\n                    shouldThrow&lt;IllegalArgumentException&gt; {\n                        sut.calculate(it)\n                    }\n                }\n            }\n        }\n    }\n})</code>\n        </deckgo-highlight-code>\n<h3 id=\"kotest-assertions\" style=\"position:relative;\"><a href=\"#kotest-assertions\" aria-label=\"kotest assertions permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kotest Assertions</h3>\n<p>위에 작성한 예제 코드에서는 Kotest의 Assertion이 사용되었습니다. Kotest에서 제공하는 간단한 몇가지 Assertion 표현식을 살펴보겠습니다.</p>\n<ul>\n<li>\n<p><strong>Assertions</strong></p>\n<ul>\n<li>shouldBe</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">name shouldBe &quot;kyunam&quot;\n\n// == assertThat(name).isEqualTo(&quot;kyunam&quot;)</code>\n        </deckgo-highlight-code>\n</li>\n<li>\n<p><strong>Inspectors</strong></p>\n<ul>\n<li>forExactly</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">mylist.forExactly(3) {\n    it.city shouldBe &quot;Chicago&quot;\n}</code>\n        </deckgo-highlight-code>\n<ul>\n<li>forAtLeast</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">val xs = listOf(&quot;sam&quot;, &quot;gareth&quot;, &quot;timothy&quot;, &quot;muhammad&quot;)\n\nxs.forAtLeast(2) {\n    it.shouldHaveMinLength(7)\n}</code>\n        </deckgo-highlight-code>\n</li>\n<li>\n<p><strong>Exceptions</strong></p>\n<ul>\n<li>shouldThrow</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">shouldThrow&lt;IllegalAccessException&gt; {\n  // code in here that you expect to throw an IllegalAccessException\n}\n\n// == assertThrows&lt;IllegalAccessException&gt; { }</code>\n        </deckgo-highlight-code>\n<ul>\n<li>shouldThrowAny</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">val exception = shouldThrowAny {\n  // test here can throw any type of Throwable!\n}</code>\n        </deckgo-highlight-code>\n</li>\n</ul>\n<h3 id=\"kotest-with-springboottest\" style=\"position:relative;\"><a href=\"#kotest-with-springboottest\" aria-label=\"kotest with springboottest permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kotest with @SpringBootTest</h3>\n<p><code class=\"language-text\">@SpringBootTest</code>와 같은 통합 테스트에서도 Kotest의 테스트 레이아웃을 사용할 수 있습니다.</p>\n<p>사용을 위해서는 아래와 같은 spring extension 의존성의 추가가 필요합니다.</p>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">dependencies {\n    testImplementation(&quot;io.kotest:kotest-extensions-spring:${Versions.KOTEST}&quot;)\n}</code>\n        </deckgo-highlight-code>\n<ul>\n<li><a href=\"https://github.com/kyucumber/kotlin-testing-with-spring-boot/blob/master/src/test/kotlin/org/kyucumber/CalculatorSpringBootSpec.kt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kotest - using <code class=\"language-text\">@SpringBootTest</code></a></li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">@SpringBootTest\ninternal class CalculatorSpringBootSpec : DescribeSpec() {\n    override fun extensions() = listOf(SpringExtension)\n\n    @Autowired\n    private lateinit var calculatorService: CalculatorService\n\n    init {\n        this.describe(&quot;calculate&quot;) {\n            context(&quot;식이 주어지면&quot;) {\n                val inputs = listOf(\n                    &quot;1 + 3 * 5&quot; to 20.0,\n                    &quot;2 - 8 / 3 - 3&quot; to -5.0,\n                    &quot;1 + 2 + 3 + 4 + 5&quot; to 15.0\n                )\n                it(&quot;해당 식에 대한 결과값이 반환된다&quot;) {\n                    inputs.forAll { (expression, data) -&gt;\n                        val result = calculatorService.calculate(expression)\n\n                        result shouldBe data\n                    }\n                }\n            }\n        }\n    }\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"kotest-isolation-mode\" style=\"position:relative;\"><a href=\"#kotest-isolation-mode\" aria-label=\"kotest isolation mode permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kotest Isolation Mode</h3>\n<p>Kotest는 아래와 같이 테스트 간 격리에 대한 설정을 제공하고 있습니다.</p>\n<ul>\n<li>\n<p><a href=\"https://github.com/kotest/kotest/blob/master/doc/isolation_mode.md\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Kotest Isolation Mode</a></p>\n<ul>\n<li><strong>SingleInstance - 기본값</strong></li>\n<li>InstancePerTest</li>\n<li>InstancePerLeaf</li>\n</ul>\n</li>\n</ul>\n<p>Kotest에서는 테스트 간 격리 레벨에 대해 디폴트로 SingleInstance를 설정하고 있으며 이 경우 Mocking 등 때문에 테스트 간 충돌이 발생할 수 있습니다. 따라서 테스트간 완전한 격리를 위해서는 아래와 같이 IsolationMode를 <code class=\"language-text\">InstancePerLeaf</code>로 지정해 사용해야 합니다.</p>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">internal class CalculatorDescribeSpec : DescribeSpec({\n    isolationMode = IsolationMode.InstancePerLeaf\n    // ...\n})</code>\n        </deckgo-highlight-code>\n<h2 id=\"mockk\" style=\"position:relative;\"><a href=\"#mockk\" aria-label=\"mockk permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mockk</h2>\n<p>Mockk는 코틀린 스타일의 Mock 프레임워크입니다.\nMockito를 사용하는 경우 아래처럼 코틀린 DSL 스타일의 테스트를 작성할 수 없습니다.</p>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">given(userRepository.findById(1L).willReturn(expectedUser)</code>\n        </deckgo-highlight-code>\n<p>Mockk를 사용하면 아래와 같이 코틀린 DSL 스타일로 Mock 테스트를 작성할 수 있습니다.</p>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">every { userRepository.findById(1L) } answers { expectedUser }</code>\n        </deckgo-highlight-code>\n<p>Mockk의 사용을 위해서는 아래와 같은 의존성 추가가 필요합니다.</p>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">dependencies {\n    testImplementation(&quot;io.mockk:mockk:10.10.6&quot;)\n}</code>\n        </deckgo-highlight-code>\n<h3 id=\"mockk-features\" style=\"position:relative;\"><a href=\"#mockk-features\" aria-label=\"mockk features permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mockk features</h3>\n<p>Mockito와 큰 차이가 없습니다. 대응되는 키워드만 잘 찾으면 러닝커브 없이 바로 사용이 가능합니다.</p>\n<ul>\n<li><strong>Mocking</strong></li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">val permissionRepository = mockk&lt;PermissionRepository&gt;()</code>\n        </deckgo-highlight-code>\n<ul>\n<li><strong>SpyK</strong></li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">val car = spyk(Car()) // or spyk&lt;Car&gt;() to call default constructor</code>\n        </deckgo-highlight-code>\n<ul>\n<li><strong>Constructor mocks</strong></li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">class MockCls {\n  fun add(a: Int, b: Int) = a + b\n}\n\nmockkConstructor(MockCls::class)\n\nevery { anyConstructed&lt;MockCls&gt;().add(1, 2) } returns 4\n\nassertEquals(4, MockCls().add(1, 2)) // note new object is created\n\nverify { anyConstructed&lt;MockCls&gt;().add(1, 2) }</code>\n        </deckgo-highlight-code>\n<ul>\n<li><strong>Relaxed mock</strong></li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">val car = mockk&lt;PermissionRepository&gt;(relaxed = true)\n\n// unnecessary\n// every { permissionRepository.delete(id) } just Runs</code>\n        </deckgo-highlight-code>\n<ul>\n<li>\n<p><strong>Answers</strong></p>\n<ul>\n<li>answers</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">every { permissionRepository.save(permission) } answers { permission }</code>\n        </deckgo-highlight-code>\n<ul>\n<li>throws</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">every { permissionRepository.findByIdOrNull(id) } throws EntityNotFoundException()</code>\n        </deckgo-highlight-code>\n<ul>\n<li>just Runs</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">every { permissionRepository.delete(id) } just Runs</code>\n        </deckgo-highlight-code>\n<ul>\n<li>retrunsMany</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">every { permissionRepository.save(permission) } returnsMany listOf(firstPermission, secondPermission)</code>\n        </deckgo-highlight-code>\n<ul>\n<li>returns</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">every { permissionRepository.save(permission) } retunrs permission\nevery { permissionRepository.save(permission) } retunrs firstPermission andThen secondPermission</code>\n        </deckgo-highlight-code>\n</li>\n<li>\n<p><strong>Argument matching</strong></p>\n<ul>\n<li>any</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">every { permissionRepository.save(any()) } retunrs permission</code>\n        </deckgo-highlight-code>\n<ul>\n<li>varargs</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">every { obj.manyMany(5, 6, *varargAll { it == 7 }) } returns 3\n\nprintln(obj.manyMany(5, 6, 7)) // 3\nprintln(obj.manyMany(5, 6, 7, 7)) // 3\nprintln(obj.manyMany(5, 6, 7, 7, 7)) // 3\n\nevery { obj.manyMany(5, 6, *varargAny { nArgs &gt; 5 }, 7) } returns 5\n\nprintln(obj.manyMany(5, 6, 4, 5, 6, 7)) // 5\nprintln(obj.manyMany(5, 6, 4, 5, 6, 7, 7)) // 5</code>\n        </deckgo-highlight-code>\n</li>\n<li>\n<p><strong>Verification</strong></p>\n<ul>\n<li>verify</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">verify(atLeast = 3) { car.accelerate(allAny()) }\nverify(atMost  = 2) { car.accelerate(fromSpeed = 10, toSpeed = or(20, 30)) }\nverify(exactly = 1) { car.accelerate(fromSpeed = 10, toSpeed = 20) }\nverify(exactly = 0) { car.accelerate(fromSpeed = 30, toSpeed = 10) } // means no calls were performed</code>\n        </deckgo-highlight-code>\n<ul>\n<li>verifyAll</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">verifyAll {\n    obj.sum(1, 3)\n    obj.sum(1, 2)\n    obj.sum(2, 2)\n}</code>\n        </deckgo-highlight-code>\n<ul>\n<li>verifySequnece</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">verifySequence {\n    obj.sum(1, 2)\n    obj.sum(1, 3)\n    obj.sum(2, 2)\n}</code>\n        </deckgo-highlight-code>\n</li>\n</ul>\n<h2 id=\"springmockk-spek\" style=\"position:relative;\"><a href=\"#springmockk-spek\" aria-label=\"springmockk spek permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SpringMockk, Spek</h2>\n<p>이외에 아래와 같은 테스트 도구들도 있습니다.</p>\n<ul>\n<li>\n<p>SpringMockk</p>\n<ul>\n<li><code class=\"language-text\">@MockkBean</code> , <code class=\"language-text\">@SpykBean</code> 기능 제공</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">@MockkBean // @MockBean 대신 @MockkBean 사용 가능\nprivate lateinit var userRepository: UserRepository</code>\n        </deckgo-highlight-code>\n</li>\n<li>\n<p>Spek</p>\n<ul>\n<li>Kotest의 Describe Spec의 기능 제공</li>\n</ul>\n</li>\n</ul>\n<deckgo-highlight-code language=\"kotlin\" terminal=\"carbon\" theme=\"one-light\"  >\n          <code slot=\"code\">internal class CalculatorDescribeSpec : Spek({\n    val sut = Calculator()\n\n    describe(&quot;calculate&quot;) {\n        context(&quot;식이 주어지면&quot;) {\n            val inputs = listOf(\n                &quot;1 + 3 * 5&quot; to 20.0,\n                &quot;2 - 8 / 3 - 3&quot; to -5.0,\n                &quot;1 + 2 + 3 + 4 + 5&quot; to 15.0\n            )\n\n            it(&quot;해당 식에 대한 결과값이 반환된다&quot;) {\n                inputs.forAll { (expression, data) -&gt;\n                    val result = sut.calculate(expression)\n\n                    result shouldBe data\n                }\n            }\n        }\n\n        context(&quot;0으로 나누는 경우&quot;) {\n            it(&quot;Infinity를 반환한다&quot;) {\n                val result = sut.calculate(&quot;1 / 0&quot;)\n\n                result shouldBe Double.POSITIVE_INFINITY\n            }\n        }\n\n        context(&quot;입력값이 null이거나 공백인 경우&quot;) {\n            val blanks = listOf(&quot;&quot;, &quot; &quot;, &quot;      &quot;)\n            it(&quot;IllegalArgumentException 예외를 던진다&quot;) {\n                blanks.forAll {\n                    shouldThrow&lt;IllegalArgumentException&gt; {\n                        sut.calculate(it)\n                    }\n                }\n            }\n        }\n\n        context(&quot;사칙연산 기호 이외에 다른 문자가 연산자로 들어오는 경우&quot;) {\n            val invalidInputs = listOf(&quot;1 &amp; 2&quot;, &quot;1 + 5 % 1&quot;)\n            it(&quot;IllegalArgumentException 예외를 던진다&quot;) {\n                invalidInputs.forAll {\n                    shouldThrow&lt;IllegalArgumentException&gt; {\n                        sut.calculate(it)\n                    }\n                }\n            }\n        }\n    }\n})</code>\n        </deckgo-highlight-code>\n<h2 id=\"reference\" style=\"position:relative;\"><a href=\"#reference\" aria-label=\"reference permalink\" class=\"anchor-header before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reference</h2>\n<ul>\n<li><a href=\"https://kotest.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://kotest.io</a></li>\n<li><a href=\"https://mockk.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://mockk.io/</a></li>\n<li><a href=\"https://kotlinlang.org/docs/type-safe-builders.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://kotlinlang.org</a></li>\n</ul>","tableOfContents":"<ul>\n<li><a href=\"/posts/spring/kotlin-test-with-spring/#%EA%B0%9C%EC%9A%94\">개요</a></li>\n<li><a href=\"/posts/spring/kotlin-test-with-spring/#%EC%BD%94%ED%8B%80%EB%A6%B0-dsl%EA%B3%BC-%EC%BD%94%ED%8B%80%EB%A6%B0-%EC%8A%A4%ED%83%80%EC%9D%BC%EC%9D%98-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%BD%94%EB%93%9C\">코틀린 DSL과 코틀린 스타일의 테스트코드</a></li>\n<li>\n<p><a href=\"/posts/spring/kotlin-test-with-spring/#kotest\">Kotest</a></p>\n<ul>\n<li><a href=\"/posts/spring/kotlin-test-with-spring/#kotest-test-framework\">Kotest Test Framework</a></li>\n<li><a href=\"/posts/spring/kotlin-test-with-spring/#kotest-assertions\">Kotest Assertions</a></li>\n<li><a href=\"/posts/spring/kotlin-test-with-spring/#kotest-with-springboottest\">Kotest with @SpringBootTest</a></li>\n<li><a href=\"/posts/spring/kotlin-test-with-spring/#kotest-isolation-mode\">Kotest Isolation Mode</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"/posts/spring/kotlin-test-with-spring/#mockk\">Mockk</a></p>\n<ul>\n<li><a href=\"/posts/spring/kotlin-test-with-spring/#mockk-features\">Mockk features</a></li>\n</ul>\n</li>\n<li><a href=\"/posts/spring/kotlin-test-with-spring/#springmockk-spek\">SpringMockk, Spek</a></li>\n<li><a href=\"/posts/spring/kotlin-test-with-spring/#reference\">Reference</a></li>\n</ul>","fields":{"slug":"/posts/spring/kotlin-test-with-spring","tagSlugs":["/tag/spring/","/tag/kotlin/","/tag/kotest/","/tag/mockk/"]},"frontmatter":{"date":"2021-06-06T00:00:00.000Z","description":"스프링에서 코틀린 스타일 테스트 코드 작성하기","tags":["Spring","Kotlin","Kotest","Mockk"],"title":"스프링에서 코틀린 스타일 테스트 코드 작성하기","socialImage":{"publicURL":"/static/3fb2d4de4502fbae8b21ee45fe945cf4/kyucumber.jpg"}}}},"pageContext":{"slug":"/posts/spring/kotlin-test-with-spring"}},"staticQueryHashes":["2067870509","251939775","401334301"]}